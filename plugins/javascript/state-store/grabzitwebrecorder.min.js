function GrabzIt(e){return new function(e){this.key=e,this.Create=function(e,t){var r="//";"https"!=window.location.protocol&&"http"!=window.location.protocol&&(r="http://");var o=r+"api.grabz.it/services/javascript.ashx?key="+encodeURIComponent(this.key)+"&url="+encodeURIComponent(e);for(var i in t){if("format"!=i&&"cache"!=i&&"customWaterMarkId"!=i&&"quality"!=i&&"country"!=i&&"filename"!=i&&"errorid"!=i&&"errorclass"!=i&&"onfinish"!=i&&"onerror"!=i&&"delay"!=i&&"bwidth"!=i&&"bheight"!=i&&"height"!=i&&"width"!=i&&"target"!=i&&"requestas"!=i&&"download"!=i&&"suppresserrors"!=i&&"displayid"!=i&&"displayclass"!=i&&"background"!=i&&"pagesize"!=i&&"orientation"!=i&&"includelinks"!=i&&"includeoutline"!=i&&"title"!=i&&"coverurl"!=i&&"mtop"!=i&&"mleft"!=i&&"mbottom"!=i&&"mright"!=i&&"tabletoinclude"!=i&&"includeheadernames"!=i&&"includealltables"!=i&&"start"!=i&&"duration"!=i&&"speed"!=i&&"fps"!=i&&"repeat"!=i&&"reverse"!=i)throw"Option "+i+" not recognized!";var a=t[i];null!=a&&(o+="&"+i+"="+encodeURIComponent(a))}var n=document.createElement("script");return n.src=o,n},this.AddTo=function(e,t,r){var o=null;if("string"==typeof e||e instanceof String){if(o=document.getElementById(e),null==o)throw"An element with the id "+e+" was not found"}else 1===e.nodeType&&(o=e);if(null==o)throw"No valid element was provided to attach the screenshot to";o.appendChild(this.Create(t,r))}}(e)}function GrabzItWebRecorder(){this.timeoutIds=new Array,this.intervalIds=new Array,this.targetId="",this.record=function(e){this.targetId=e},this.freeze=function(){for(var e=0;e<this.timeoutIds.length;e++)clearTimeout(this.timeoutIds[e]);for(var t=0;t<this.intervalIds.length;t++)clearInterval(this.intervalIds[t]);throw new Error("Frozen")},this.setTimeoutId=function(e){this.timeoutIds.push(e)},this.setIntervalId=function(e){this.intervalIds.push(e)},this.load=function(){(null==this.targetId||""==this.targetId)&&alert("Please use the record() method to specify a target element to record.");var e=this.getQueryStringValue();if(""!=e){var t=GrabzItLZString.decompressFromBase64(e),r=document.getElementById(this.targetId);if(null==r)return alert("The target element can not be found."),"";r.innerHTML=t,this.freeze()}},this.AppendURL=function(e){null==e&&(e=location.href);var t=this.getState();return e+=-1==e.indexOf("?")?"?":"&",e+"grabzit="+t},this.AddTo=function(e,t,r){GrabzIt(e).AddTo(t,this.AppendURL(),r)},this.Create=function(e,t){return GrabzIt(e).Create(this.AppendURL(),t)},this.getQueryStringValue=function(){return unescape(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+escape("grabzit").replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))},this.isRecording=function(){return""!=this.getQueryStringValue()},this.getState=function(){var e=document.getElementById(this.targetId);if(null==e)return alert("The target element can not be found."),"";this.formatNode(e);var t=e.cloneNode(!0);this.minifyNode(t);var r=t.innerHTML.replace(/\>(\r\n|\n|\r)/gm,">"),o=GrabzItLZString.compressToBase64(r);return o.length>2048?(alert("The size of the web data you are trying to send to GrabzIt is too large. Try to reduce this by specifiying a id of a element that more tightly wraps the data you are interested in recording."),""):o},this.minifyNode=function(e){if(void 0!==e){if(e.tagName&&"a"==e.tagName.toLowerCase()){var t=e.getAttribute("href");null!=t&&""!=t&&e.setAttribute("href","#")}if(e.tagName&&"img"==e.tagName.toLowerCase()){var r=e.getAttribute("src");null!=r&&e.setAttribute("src",r.replace(/^(https?):\/\//,"//"))}if(1==e.nodeType){var o=e.getAttribute("value");if((null==o||""==o||null!=e.tagName&&"input"==e.tagName.toLowerCase()&&null!=e.getAttribute("type")&&("checkbox"==e.getAttribute("type").toLowerCase()||"radio"==e.getAttribute("type").toLowerCase()))&&e.removeAttribute("value"),null!=e.tagName&&"select"==e.tagName.toLowerCase())for(var i=0;i<e.childNodes.length;i++)e.childNodes[i].tagName&&null==e.childNodes[i].getAttribute("selected")&&e.removeChild(e.childNodes[i]),e.childNodes[i].tagName&&"option"==e.childNodes[i].tagName.toLowerCase()&&e.childNodes[i].removeAttribute("selected");e.removeAttribute("alt"),e.removeAttribute("title"),e.removeAttribute("onclick"),e.removeAttribute("onchange"),e.removeAttribute("onload"),e.removeAttribute("onafterprint"),e.removeAttribute("onbeforeprint"),e.removeAttribute("onbeforeunload"),e.removeAttribute("onerror"),e.removeAttribute("onhashchange"),e.removeAttribute("onmessage"),e.removeAttribute("onoffline"),e.removeAttribute("online"),e.removeAttribute("onpagehide"),e.removeAttribute("onpageshow"),e.removeAttribute("onpopstate"),e.removeAttribute("onresize"),e.removeAttribute("onstorage"),e.removeAttribute("onunload"),e.removeAttribute("onblur"),e.removeAttribute("oncontextmenu"),e.removeAttribute("onfocus"),e.removeAttribute("oninput"),e.removeAttribute("oninvalid"),e.removeAttribute("onreset"),e.removeAttribute("onsearch"),e.removeAttribute("onselect"),e.removeAttribute("onkeydown"),e.removeAttribute("onkeypress"),e.removeAttribute("onkeyup"),e.removeAttribute("ondblclick"),e.removeAttribute("ondrag"),e.removeAttribute("ondragend"),e.removeAttribute("ondragenter"),e.removeAttribute("ondragstart"),e.removeAttribute("ondrop"),e.removeAttribute("onmousedown"),e.removeAttribute("onmousemove"),e.removeAttribute("onmouseout"),e.removeAttribute("onmouseover"),e.removeAttribute("onmouseup"),e.removeAttribute("onmousewheel"),e.removeAttribute("onscroll"),e.removeAttribute("onwheel")}for(var i=0;i<e.childNodes.length;i++)this.minifyNode(e.childNodes[i])}},this.formatNode=function(e){if(void 0!==e){if(null!=e.value)if(e.tagName&&"textarea"==e.tagName.toLowerCase())e.innerHTML=e.value;else if(e.tagName&&"select"==e.tagName.toLowerCase())for(var t=0;t<e.childNodes.length;t++)e.childNodes[t].tagName&&"option"==e.childNodes[t].tagName.toLowerCase()&&(e.childNodes[t].removeAttribute("selected"),e.childNodes[t].value==e.value&&e.childNodes[t].setAttribute("selected","selected"));else null!=e.value&&""!=e.value&&e.setAttribute("value",e.value);e.checked?e.setAttribute("checked","checked"):e.tagName&&"input"==e.tagName.toLowerCase()&&e.removeAttribute("checked");for(var t=0;t<e.childNodes.length;t++)this.formatNode(e.childNodes[t])}};!function(e){var t=window.onload;window.onload=function(){e.load(),null!=t&&t()}}(this)}var GrabzItLZString={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(e){if(null==e)return"";var t,r,o,i,a,n,s,c="",l=0;for(e=GrabzItLZString.compress(e);l<2*e.length;)l%2==0?(t=e.charCodeAt(l/2)>>8,r=255&e.charCodeAt(l/2),o=l/2+1<e.length?e.charCodeAt(l/2+1)>>8:0/0):(t=255&e.charCodeAt((l-1)/2),(l+1)/2<e.length?(r=e.charCodeAt((l+1)/2)>>8,o=255&e.charCodeAt((l+1)/2)):r=o=0/0),l+=3,i=t>>2,a=(3&t)<<4|r>>4,n=(15&r)<<2|o>>6,s=63&o,isNaN(r)?n=s=64:isNaN(o)&&(s=64),c=c+GrabzItLZString._keyStr.charAt(i)+GrabzItLZString._keyStr.charAt(a)+GrabzItLZString._keyStr.charAt(n)+GrabzItLZString._keyStr.charAt(s);return c},decompressFromBase64:function(e){if(null==e)return"";var t,r,o,i,a,n,s,c,l="",u=0,d=0,h=GrabzItLZString._f;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");d<e.length;)a=GrabzItLZString._keyStr.indexOf(e.charAt(d++)),n=GrabzItLZString._keyStr.indexOf(e.charAt(d++)),s=GrabzItLZString._keyStr.indexOf(e.charAt(d++)),c=GrabzItLZString._keyStr.indexOf(e.charAt(d++)),r=a<<2|n>>4,o=(15&n)<<4|s>>2,i=(3&s)<<6|c,u%2==0?(t=r<<8,64!=s&&(l+=h(t|o)),64!=c&&(t=i<<8)):(l+=h(t|r),64!=s&&(t=o<<8),64!=c&&(l+=h(t|i))),u+=3;return GrabzItLZString.decompress(l)},compressToUTF16:function(e){if(null==e)return"";var t,r,o,i="",a=0,n=GrabzItLZString._f;for(e=GrabzItLZString.compress(e),t=0;t<e.length;t++)switch(r=e.charCodeAt(t),a++){case 0:i+=n((r>>1)+32),o=(1&r)<<14;break;case 1:i+=n(o+(r>>2)+32),o=(3&r)<<13;break;case 2:i+=n(o+(r>>3)+32),o=(7&r)<<12;break;case 3:i+=n(o+(r>>4)+32),o=(15&r)<<11;break;case 4:i+=n(o+(r>>5)+32),o=(31&r)<<10;break;case 5:i+=n(o+(r>>6)+32),o=(63&r)<<9;break;case 6:i+=n(o+(r>>7)+32),o=(127&r)<<8;break;case 7:i+=n(o+(r>>8)+32),o=(255&r)<<7;break;case 8:i+=n(o+(r>>9)+32),o=(511&r)<<6;break;case 9:i+=n(o+(r>>10)+32),o=(1023&r)<<5;break;case 10:i+=n(o+(r>>11)+32),o=(2047&r)<<4;break;case 11:i+=n(o+(r>>12)+32),o=(4095&r)<<3;break;case 12:i+=n(o+(r>>13)+32),o=(8191&r)<<2;break;case 13:i+=n(o+(r>>14)+32),o=(16383&r)<<1;break;case 14:i+=n(o+(r>>15)+32,(32767&r)+32),a=0}return i+n(o+32)},decompressFromUTF16:function(e){if(null==e)return"";for(var t,r,o="",i=0,a=0,n=GrabzItLZString._f;a<e.length;){switch(r=e.charCodeAt(a)-32,i++){case 0:t=r<<1;break;case 1:o+=n(t|r>>14),t=(16383&r)<<2;break;case 2:o+=n(t|r>>13),t=(8191&r)<<3;break;case 3:o+=n(t|r>>12),t=(4095&r)<<4;break;case 4:o+=n(t|r>>11),t=(2047&r)<<5;break;case 5:o+=n(t|r>>10),t=(1023&r)<<6;break;case 6:o+=n(t|r>>9),t=(511&r)<<7;break;case 7:o+=n(t|r>>8),t=(255&r)<<8;break;case 8:o+=n(t|r>>7),t=(127&r)<<9;break;case 9:o+=n(t|r>>6),t=(63&r)<<10;break;case 10:o+=n(t|r>>5),t=(31&r)<<11;break;case 11:o+=n(t|r>>4),t=(15&r)<<12;break;case 12:o+=n(t|r>>3),t=(7&r)<<13;break;case 13:o+=n(t|r>>2),t=(3&r)<<14;break;case 14:o+=n(t|r>>1),t=(1&r)<<15;break;case 15:o+=n(t|r),i=0}a++}return GrabzItLZString.decompress(o)},compress:function(e){if(null==e)return"";var t,r,o,i={},a={},n="",s="",c="",l=2,u=3,d=2,h="",b=0,m=0,f=GrabzItLZString._f;for(o=0;o<e.length;o+=1)if(n=e.charAt(o),Object.prototype.hasOwnProperty.call(i,n)||(i[n]=u++,a[n]=!0),s=c+n,Object.prototype.hasOwnProperty.call(i,s))c=s;else{if(Object.prototype.hasOwnProperty.call(a,c)){if(c.charCodeAt(0)<256){for(t=0;d>t;t++)b<<=1,15==m?(m=0,h+=f(b),b=0):m++;for(r=c.charCodeAt(0),t=0;8>t;t++)b=b<<1|1&r,15==m?(m=0,h+=f(b),b=0):m++,r>>=1}else{for(r=1,t=0;d>t;t++)b=b<<1|r,15==m?(m=0,h+=f(b),b=0):m++,r=0;for(r=c.charCodeAt(0),t=0;16>t;t++)b=b<<1|1&r,15==m?(m=0,h+=f(b),b=0):m++,r>>=1}l--,0==l&&(l=Math.pow(2,d),d++),delete a[c]}else for(r=i[c],t=0;d>t;t++)b=b<<1|1&r,15==m?(m=0,h+=f(b),b=0):m++,r>>=1;l--,0==l&&(l=Math.pow(2,d),d++),i[s]=u++,c=String(n)}if(""!==c){if(Object.prototype.hasOwnProperty.call(a,c)){if(c.charCodeAt(0)<256){for(t=0;d>t;t++)b<<=1,15==m?(m=0,h+=f(b),b=0):m++;for(r=c.charCodeAt(0),t=0;8>t;t++)b=b<<1|1&r,15==m?(m=0,h+=f(b),b=0):m++,r>>=1}else{for(r=1,t=0;d>t;t++)b=b<<1|r,15==m?(m=0,h+=f(b),b=0):m++,r=0;for(r=c.charCodeAt(0),t=0;16>t;t++)b=b<<1|1&r,15==m?(m=0,h+=f(b),b=0):m++,r>>=1}l--,0==l&&(l=Math.pow(2,d),d++),delete a[c]}else for(r=i[c],t=0;d>t;t++)b=b<<1|1&r,15==m?(m=0,h+=f(b),b=0):m++,r>>=1;l--,0==l&&(l=Math.pow(2,d),d++)}for(r=2,t=0;d>t;t++)b=b<<1|1&r,15==m?(m=0,h+=f(b),b=0):m++,r>>=1;for(;;){if(b<<=1,15==m){h+=f(b);break}m++}return h},decompress:function(e){if(null==e)return"";if(""==e)return null;var t,r,o,i,a,n,s,c,l=[],u=4,d=4,h=3,b="",m="",f=GrabzItLZString._f,p={string:e,val:e.charCodeAt(0),position:32768,index:1};for(r=0;3>r;r+=1)l[r]=r;for(i=0,n=Math.pow(2,2),s=1;s!=n;)a=p.val&p.position,p.position>>=1,0==p.position&&(p.position=32768,p.val=p.string.charCodeAt(p.index++)),i|=(a>0?1:0)*s,s<<=1;switch(t=i){case 0:for(i=0,n=Math.pow(2,8),s=1;s!=n;)a=p.val&p.position,p.position>>=1,0==p.position&&(p.position=32768,p.val=p.string.charCodeAt(p.index++)),i|=(a>0?1:0)*s,s<<=1;c=f(i);break;case 1:for(i=0,n=Math.pow(2,16),s=1;s!=n;)a=p.val&p.position,p.position>>=1,0==p.position&&(p.position=32768,p.val=p.string.charCodeAt(p.index++)),i|=(a>0?1:0)*s,s<<=1;c=f(i);break;case 2:return""}for(l[3]=c,o=m=c;;){if(p.index>p.string.length)return"";for(i=0,n=Math.pow(2,h),s=1;s!=n;)a=p.val&p.position,p.position>>=1,0==p.position&&(p.position=32768,p.val=p.string.charCodeAt(p.index++)),i|=(a>0?1:0)*s,s<<=1;switch(c=i){case 0:for(i=0,n=Math.pow(2,8),s=1;s!=n;)a=p.val&p.position,p.position>>=1,0==p.position&&(p.position=32768,p.val=p.string.charCodeAt(p.index++)),i|=(a>0?1:0)*s,s<<=1;l[d++]=f(i),c=d-1,u--;break;case 1:for(i=0,n=Math.pow(2,16),s=1;s!=n;)a=p.val&p.position,p.position>>=1,0==p.position&&(p.position=32768,p.val=p.string.charCodeAt(p.index++)),i|=(a>0?1:0)*s,s<<=1;l[d++]=f(i),c=d-1,u--;break;case 2:return m}if(0==u&&(u=Math.pow(2,h),h++),l[c])b=l[c];else{if(c!==d)return null;b=o+o.charAt(0)}m+=b,l[d++]=o+b.charAt(0),u--,o=b,0==u&&(u=Math.pow(2,h),h++)}}},GrabzItWebRecorder=new GrabzItWebRecorder;window.GrabzItSetTimeout=window.setTimeout,window.setTimeout=function(e,t){var r=window.GrabzItSetTimeout(e,t);return GrabzItWebRecorder.setTimeoutId(r),r},window.GrabzItSetInterval=window.setInterval,window.setInterval=function(e,t){var r=window.GrabzItSetInterval(e,t);return GrabzItWebRecorder.setIntervalId(r),r};